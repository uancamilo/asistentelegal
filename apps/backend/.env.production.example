# ==========================================
# AsistenciaLegal - Production Environment Variables
# ==========================================
#
# IMPORTANT: This is a TEMPLATE for production deployment.
# Copy this file and fill with REAL production values.
#
# NEVER commit actual production .env files to Git!
# Use your hosting provider's environment variable system instead.
# ==========================================

# ==========================================
# DATABASE CONFIGURATION
# ==========================================
# Use your production PostgreSQL connection string (Neon, AWS RDS, etc.)
# IMPORTANT: Use connection pooling for production
DATABASE_URL="postgresql://USER:PASSWORD@HOST:PORT/DATABASE?sslmode=require&connection_limit=10"

# ==========================================
# SUPER ADMIN CREDENTIALS
# ==========================================
# Used ONLY for initial setup with: npm run init-superadmin
# ⚠️ CRITICAL SECURITY:
# 1. Use a strong password (min 24 characters)
# 2. Change immediately after first login
# 3. Enable 2FA if available
# 4. NEVER share these credentials

ADMIN_EMAIL="admin@yourcompany.com"
ADMIN_PASSWORD="GENERATE_WITH_openssl_rand_base64_32"

# ==========================================
# EMPLOYEE CREDENTIALS
# ==========================================
# Used ONLY for initial setup with: npm run init-admins
# Generate with: openssl rand -base64 32

SECONDARY_ADMIN_PASSWORD="GENERATE_WITH_openssl_rand_base64_32"
EDITOR_PASSWORD="GENERATE_WITH_openssl_rand_base64_32"

# ==========================================
# NESTJS APPLICATION CONFIGURATION
# ==========================================
# Port: Let your hosting provider assign (Railway, Render auto-detect)
# Or use a specific port if needed
PORT=8080

# Environment: MUST be 'production'
NODE_ENV=production

# ==========================================
# CORS CONFIGURATION
# ==========================================
# CRITICAL SECURITY: Use your actual frontend domain with HTTPS
# NO wildcards in production!
# Example: https://yourapp.vercel.app

CORS_ORIGIN=https://yourfrontend.vercel.app

# Frontend URL for emails and redirects
# Must match CORS_ORIGIN
FRONTEND_URL=https://yourfrontend.vercel.app

# ==========================================
# JWT CONFIGURATION
# ==========================================
# CRITICAL SECURITY:
# 1. Generate with: openssl rand -base64 32
# 2. JWT_SECRET and JWT_REFRESH_SECRET MUST be different
# 3. Rotate every 90 days
# 4. Store in hosting provider's secrets manager

JWT_SECRET="GENERATE_WITH_openssl_rand_base64_32"
JWT_EXPIRATION=15m
JWT_REFRESH_SECRET="GENERATE_DIFFERENT_VALUE_WITH_openssl_rand_base64_32"
JWT_REFRESH_EXPIRATION=7d

# ==========================================
# REDIS CONFIGURATION (HIGHLY RECOMMENDED)
# ==========================================
# Use managed Redis for production:
# - Railway: Built-in Redis addon
# - Render: Redis service
# - Upstash: Serverless Redis
# - Redis Cloud: Free tier available
#
# Format: redis://default:password@host:port
# Example Railway: redis://default:password@redis.railway.internal:6379

REDIS_URL=redis://default:YOUR_REDIS_PASSWORD@your-redis-host:6379

# ==========================================
# OPENAI CONFIGURATION
# ==========================================
# Get API key from: https://platform.openai.com/api-keys
#
# CRITICAL SECURITY:
# 1. Use a production-specific API key
# 2. Set usage limits in OpenAI dashboard
# 3. Monitor costs daily
# 4. Rotate every 90 days

OPENAI_API_KEY="sk-..."
OPENAI_EMBEDDING_MODEL=text-embedding-3-small
OPENAI_CHAT_MODEL=gpt-3.5-turbo
OPENAI_MAX_TOKENS=1000
OPENAI_TEMPERATURE=0.7

# ==========================================
# FILE STORAGE CONFIGURATION
# ==========================================
# CRITICAL: Use S3-compatible storage in production
# Local storage is NOT persistent on platforms like Railway/Render

STORAGE_TYPE=s3

# Maximum file size (50MB default)
MAX_FILE_SIZE=52428800

# Allowed MIME types
ALLOWED_MIME_TYPES=application/pdf

# ==========================================
# AWS S3 CONFIGURATION (REQUIRED for production)
# ==========================================
# Get credentials from AWS IAM console
# Or use alternatives: Cloudflare R2, Backblaze B2, DigitalOcean Spaces
#
# SECURITY: Use IAM role or access keys with minimal permissions

AWS_ACCESS_KEY_ID=your-access-key-id
AWS_SECRET_ACCESS_KEY=your-secret-access-key
AWS_REGION=us-east-1
AWS_S3_BUCKET=yourapp-documents-prod

# ==========================================
# BULL QUEUE CONFIGURATION
# ==========================================
# Bull uses Redis (configured above)

QUEUE_PDF_CONCURRENCY=2
QUEUE_MAX_RETRIES=3

# ==========================================
# PRODUCTION DEPLOYMENT CHECKLIST
# ==========================================
# Before deploying, ensure:
#
# ✅ All secrets generated with openssl rand -base64 32
# ✅ JWT_SECRET ≠ JWT_REFRESH_SECRET (MUST be different!)
# ✅ NODE_ENV=production
# ✅ CORS_ORIGIN uses HTTPS only (no HTTP, no wildcards)
# ✅ Redis configured for distributed caching
# ✅ S3 or compatible storage configured
# ✅ Database has connection pooling enabled
# ✅ All credentials are strong (24+ characters)
# ✅ Run database migrations: npx prisma migrate deploy
# ✅ Run init-superadmin ONCE: npm run init-superadmin
# ✅ Change admin password immediately after first login
# ✅ Monitor OpenAI API usage
# ✅ Set up database backups
# ✅ Configure application monitoring (Sentry, etc.)
#
# ==========================================
# SECURITY BEST PRACTICES
# ==========================================
# 1. Use hosting provider's secrets manager (Railway Secrets, Vercel Env Vars)
# 2. Never commit this file with real values to Git
# 3. Rotate ALL secrets every 90 days
# 4. Use different secrets for staging and production
# 5. Enable database backups
# 6. Monitor logs for security events
# 7. Set up alerts for API usage spikes
# 8. Use HTTPS everywhere (enforced by platforms)
# 9. Keep dependencies updated (npm audit)
# 10. Review access logs regularly
# ==========================================
